#!/usr/bin/perl
#\begin{verbatim}

unless ($#ARGV >2) 
{print " program zshift  used to shift coly  by  a constant such that it is zero at a specified value of colx \n";
 print " usage: zshift  constx colx coly  *.*   \n  constx=x-value, colx,coly= columns \n *.* .. filenname\n";
 exit 0;}
 
$constx=$ARGV[0];shift @ARGV;
$colx=$ARGV[0];shift @ARGV;
$column=$ARGV[0];shift @ARGV;

$delta=1e22;
  foreach (@ARGV)
  {
   $file=$_;
   print "<".$file;
   open (Fin, $file);
   while($line=<Fin>)
   {@numbers=split(" ",$line);
        if (($d=abs($numbers[$colx-1]-$constx))<$delta)
	{$delta=$d;
	 $const=-$numbers[$coly-1];}    
        
   }
  close Fin;
   open (Fin, $file);  
   open (Fout, ">range.out");
   while($line=<Fin>)
     {
       if ($line=~/^\s*#/) {print Fout $line;}
       else{@numbers=split(" ",$line);
           	  $i=0;++$j;
		  foreach (@numbers)
		  {++$i;
		  if ($i==$column) {$numbers[$i-1]+=$const;}
		  print Fout $numbers[$i-1]." ";}     
            print Fout "\n";
           }
      }
      close Fin;
      close Fout;
       unless (rename "range.out",$file)
          {unless(open (Fout, ">$file"))     
      {die "\n error:unable to write to $file\n";}
      open (Fin, "range.out");
      while($line=<Fin>){ print Fout $line;}
      close Fin;
      close Fout;
      system "del range.out"; 
     }

   print ">\n";
   }

#\end{verbatim} 